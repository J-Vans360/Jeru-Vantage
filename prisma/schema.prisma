generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                String             @id @default(uuid())
  email             String             @unique
  name              String?
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  assessmentResults AssessmentResult[]
  studentProfile    StudentProfile?

  @@map("users")
}

model StudentProfile {
  id                       String           @id @default(uuid())
  userId                   String           @unique
  studentName              String
  currentGrade             String
  targetEntryYear          String
  citizenshipPrimary       String
  citizenshipSecondary     String?
  countryResidence         String
  annualBudgetRange        String
  needBasedAid             String
  usApplicantStatus        String
  primaryCurriculum        String
  curriculumOther          String?
  ieltsScore               Float?
  toeflScore               Int?
  duolingoScore            Int?
  nativeEnglish            Boolean          @default(false)
  satTotal                 Int?
  satMath                  Int?
  satReadingWriting        Int?
  actComposite             Int?
  ucatBmatScore            String?
  testPlanDate             String?
  testOptional             Boolean          @default(false)
  learningSupport          Boolean          @default(false)
  learningSupportDetails   String?
  disciplinaryRecord       String
  careerInterest1          String
  careerInterest2          String?
  careerInterest3          String?
  destinationCountry1      String
  destinationUniversities1 String?
  destinationCountry2      String?
  destinationUniversities2 String?
  destinationCountry3      String?
  destinationUniversities3 String?
  completed                Boolean          @default(false)
  createdAt                DateTime         @default(now())
  updatedAt                DateTime         @updatedAt
  user                     User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  subjects                 StudentSubject[]

  @@map("student_profiles")
}

model StudentSubject {
  id              String         @id @default(uuid())
  profileId       String
  subjectCategory String
  courseName      String
  difficultyLevel String
  latestGrade     String
  interestLevel   Int            @default(0)
  displayOrder    Int            @default(0)
  createdAt       DateTime       @default(now())
  profile         StudentProfile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@map("student_subjects")
}

model AssessmentResult {
  id         String   @id @default(uuid())
  userId     String
  partName   String
  domainName String
  responses  Json
  scores     Json
  completed  Boolean  @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("assessment_results")
}
