// This is your Prisma schema file for Jeru Vantage Section 0
// Learn more: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User model (you may already have this - adjust accordingly)
model User {
  id              String          @id @default(uuid())
  email           String          @unique
  name            String?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  
  // Relations
  studentProfile  StudentProfile?
  assessmentResults AssessmentResult[]
  
  @@map("users")
}

// Section 0: Student Profile
model StudentProfile {
  id                      String   @id @default(uuid())
  userId                  String   @unique
  
  // A. Demographics & Residency
  studentName             String
  currentGrade            String
  targetEntryYear         String
  citizenshipPrimary      String
  citizenshipSecondary    String?
  countryResidence        String
  
  // B. Financial Reality Check
  annualBudgetRange       String
  needBasedAid            String
  usApplicantStatus       String
  
  // C. Educational System Context
  primaryCurriculum       String
  curriculumOther         String?
  
  // E. Standardized Testing
  ieltsScore              Float?
  toeflScore              Int?
  duolingoScore           Int?
  nativeEnglish           Boolean  @default(false)
  satTotal                Int?
  satMath                 Int?
  satReadingWriting       Int?
  actComposite            Int?
  ucatBmatScore           String?
  testPlanDate            String?
  testOptional            Boolean  @default(false)
  
  // F. Learning & Disciplinary Context
  learningSupport         Boolean  @default(false)
  learningSupportDetails  String?
  disciplinaryRecord      String
  
  // G. Student Aspirations
  careerInterest1         String
  careerInterest2         String?
  careerInterest3         String?
  destinationCountry1     String
  destinationUniversities1 String?
  destinationCountry2     String?
  destinationUniversities2 String?
  destinationCountry3     String?
  destinationUniversities3 String?
  
  // Metadata
  completed               Boolean  @default(false)
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  
  // Relations
  user                    User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  subjects                StudentSubject[]
  
  @@map("student_profiles")
}

// D. Academic Data - Subject by subject
model StudentSubject {
  id              String   @id @default(uuid())
  profileId       String
  
  subjectCategory String
  courseName      String
  difficultyLevel String
  latestGrade     String
  interestLevel   Int      @default(0) // 1-5 stars
  displayOrder    Int      @default(0)
  
  createdAt       DateTime @default(now())
  
  // Relations
  profile         StudentProfile @relation(fields: [profileId], references: [id], onDelete: Cascade)
  
  @@map("student_subjects")
}

// Assessment Results (placeholder for Parts A, B, C)
model AssessmentResult {
  id              String   @id @default(uuid())
  userId          String
  
  partName        String   // "A", "B", or "C"
  domainName      String   // e.g., "Personality", "Values", etc.
  responses       Json     // Store question responses
  scores          Json     // Store calculated scores
  
  completed       Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Relations
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("assessment_results")
}
